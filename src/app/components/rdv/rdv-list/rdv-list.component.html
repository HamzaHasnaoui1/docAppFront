<nz-card nzHoverable>
  <ng-container *ngIf="rdv$ | async as rdvs; else error">
    <div class="glass-header">
      <app-search-add-actions
        searchPlaceholder="Rechercher un patient..."
        addButtonText="Nouveau Rdv"
        (searchChange)="onSearch($event)"
        (addClick)="onAdd()">
      </app-search-add-actions>
    </div>
    <nz-table
      #rdvTable
      [nzData]="rdvs"
      nzBordered
      nzSize="middle"
      [nzScroll]="{ x: '1000px' }"
    >
      <thead>
      <tr>
        <th nzWidth="120px">Date</th>
        <th nzWidth="150px">Médecin</th>
        <th nzWidth="150px">Patient</th>
        <!--
                <th nzWidth="150px">Prix du Consultation</th>
        -->
        <th nzWidth="100px">Status</th>
        <th nzWidth="100px">Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let r of rdvTable.data">
        <td>{{ r.date | date: 'dd/MM/yyyy HH:mm' }}</td>
        <td>{{ r.medecin?.nom || '—' }}</td>
        <td>{{ r.patient?.nom || '—' }}</td>
        <!--
                <td>{{ r.prix }}</td>
        -->
        <td>
          <nz-tag [nzColor]="getStatusConfig(r.statusRDV)?.color || 'default'">
            {{ getStatusConfig(r.statusRDV)?.label || 'Inconnu' }}
          </nz-tag>
        </td>
        <td class="center-cell">
          <button nz-button nz-tooltip nzTooltipTitle="Modifier" nzType="link" (click)="onEdit(r)">
            <i nz-icon nzType="edit"></i>
          </button>

          <button nz-button nz-tooltip nzTooltipTitle="Supprimer" nzType="link" nzDanger (click)="onDelete(r)">
            <i nz-icon nzType="delete"></i>
          </button>
        </td>
      </tr>
      </tbody>
    </nz-table>

    <!-- Pagination moderne -->
    <div class="modern-pagination">
      <button nz-button nzShape="circle" (click)="prevPage()" [disabled]="currentPage === 0">
        <i nz-icon nzType="left" nzTheme="outline"></i>
      </button>
      <nz-select
        class="page-selector"
        [ngModel]="currentPage + 1"
        (ngModelChange)="goToPage($event - 1)"
        nzShowSearch
        nzAllowClear>
        <nz-option
          *ngFor="let page of totalPagesArray"
          [nzLabel]="'Page ' + page"
          [nzValue]="page">
        </nz-option>
      </nz-select>
      <span class="page-info">sur {{ totalPages }}</span>
      <button nz-button nzShape="circle" (click)="nextPage()" [disabled]="currentPage === totalPages - 1">
        <i nz-icon nzType="right" nzTheme="outline"></i>
      </button>
    </div>
  </ng-container>

  <ng-template #error>
    <nz-alert nzType="error" [nzMessage]="errorMessage" nzShowIcon></nz-alert>
  </ng-template>
</nz-card>
